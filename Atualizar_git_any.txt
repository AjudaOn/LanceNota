GUIA DE ATUALIZAÇÃO - LANCENOTAS (Flask + SQLite) - GitHub -> PythonAnywhere

Remote do projeto:
git@github.com:AjudaOn/LanceNota.git

COMO ESTÁ A PRODUÇÃO HOJE (referência)
- O repositório Git está na pasta: `~/LanceNotas` (raiz do projeto)
- O deploy usa a pasta `_release/` gerada a partir do projeto (PASSO 0)
- Atualização típica em produção:
  cd ~/LanceNotas
  git pull
  ./scripts/update_release.sh
  Web > Reload

PASSO 0 - SEMPRE ANTES DE SUBIR (padrão “_release”)
Se você quer manter o mesmo padrão do outro projeto (copiar para `_release` antes do commit),
use o script abaixo para recriar a pasta `_release/` com **apenas o código de produção**:

cd /home/edir/Documentos/LanceNotas
./scripts/update_release.sh

Obs:
- O `_release/` é gerado a partir do código do projeto (não copie/suba `.venv/`, `instance/` ou PDFs).
- Se em produção o “Source code” do PythonAnywhere apontar para `_release/`, você precisará rodar esse script também no servidor após o `git pull`.

PASSO 1 - NO SEU PC (onde está o código)
cd /home/edir/Documentos/LanceNotas
git status
git add <lista_de_arquivos_alterados>   # ou: git add .
git commit -m "<mensagem_do_commit>"    # ex: "fix: ajuste horario"
git push origin main

PASSO 1.1 - CONFERÊNCIA (recomendado)
git status  (tem que ficar limpo)
git log -1 --oneline  (anote o commit)

PASSO 2 - NO PYTHONANYWHERE (bash console)
cd <PASTA_DO_PROJETO_NO_PYTHONANYWHERE>
# Exemplo (ajuste para o seu caso):
# cd /home/HTMPONTAPORA/LanceNota
# ou:
# cd /home/<seu_usuario>/LanceNota

git pull

SE SUA PRODUÇÃO USA `_release/` (opcional)
Se o PythonAnywhere estiver apontando para `_release/` como “Source code”, rode:
  ./scripts/update_release.sh

PASSO 2.1 - CONFERÊNCIA (recomendado)
git log -1 --oneline  (confira se é o mesmo commit do PASSO 1.1)

PASSO 2.2 - DEPENDÊNCIAS / MIGRATIONS (quando necessário)
Se o commit alterou `requirements.txt`:
  <ATIVAR_VENV_DO_PYTHONANYWHERE>
  pip install -r requirements.txt

Se o commit alterou migrations (pasta `migrations/`):
  <ATIVAR_VENV_DO_PYTHONANYWHERE>
  export FLASK_APP="lancenotas:create_app"
  flask db upgrade
  # Obs: há migração que normaliza dados para **3 trimestres** (trimestre>3 é ajustado para 3).

BANCO SQLITE (IMPORTANTE)
- O banco **não** vai para o Git (fica em `instance/lancenotas.sqlite3` e é ignorado).
- Primeira vez em produção, você tem 2 opções:
  A) Começar do zero (recomendado se não tiver dados reais):
     - Rodar `flask db upgrade` e deixar o sistema criar o SQLite novo.
  B) Levar os dados que você já cadastrou (turmas/alunos/atividades):
     - Subir manualmente o arquivo local `instance/lancenotas.sqlite3` para o servidor,
       no caminho do projeto: `<PASTA_DO_PROJETO_NO_PYTHONANYWHERE>/instance/lancenotas.sqlite3`
     - (Dica) faça backup antes de substituir o arquivo no servidor.

PASSO 3 - RELOAD
Vá em Web > Reload

PASSO 4 - TESTE RÁPIDO (recomendado)
1) Login como Admin (Edir) e conferir Dashboard
2) Turmas: listar em ordem, abrir uma turma e navegar entre abas/telas
3) Horário: conferir grade de Manhã/Tarde e itens de HA
4) Atividades/Lançamentos: conferir checkbox de falta justificada e médias

OBSERVAÇÕES
- Em produção não precisa (e nem deve) subir o arquivo sqlite local.
- O repositório já ignora: `.venv/`, `instance/`, `*.pdf` e outros arquivos locais.
